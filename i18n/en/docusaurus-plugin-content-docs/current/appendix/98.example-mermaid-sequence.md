---
draft: true
---

# Mermaid 시퀀스 다이어그램 예제 모음

이 문서는 Mermaid를 사용하여 시퀀스 다이어그램을 작성할 때 활용할 수 있는 다양한 기능과 문법을 예제로 보여줍니다.

## 1. 기본 참여자 및 메시지

가장 기본적인 참여자 선언과 동기/비동기/반환 메시지 예시입니다.

~~~mermaid
sequenceDiagram
    participant Alice
    participant Bob
    participant John as System Admin

    Alice->>Bob: 동기 메시지 (함수 호출)
    activate Bob
    Bob-->>Alice: 반환 메시지 (결과)
    deactivate Bob

    Alice-)+John: 비동기 메시지 (요청)
    activate John
    note right of John: 시스템 관리자 작업 처리 중
    John--)-Alice: 비동기 응답 (처리 완료 알림)
    deactivate John
~~~

**설명:**
* `participant`: 다이어그램에 참여하는 객체를 선언합니다. `as`를 사용하여 별칭을 지정할 수 있습니다.
* `->>`: 동기 메시지 (호출자는 응답을 기다림)
* `-->>`: 반환 메시지
* `-)+` 또는 `->>` (화살표 머리 모양으로 구분): 비동기 메시지 (호출자는 응답을 즉시 기다리지 않음). Mermaid에서는 명시적인 비동기 화살표 외에 일반 화살표로도 표현 후 문맥으로 설명하기도 합니다. 여기서는 `-)+` (오른쪽 화살표 머리가 채워지지 않음) 형태로 표현했습니다.
* `activate` / `deactivate`: 참여자의 활성화/비활성화 상태를 시각적으로 표현합니다.
* `note right of John: 설명`: 특정 참여자의 오른쪽에 노트를 추가합니다. (`left of`, `over` 등도 사용 가능)

## 2. 조건 분기: `alt` 와 `opt`

조건에 따라 다른 흐름이나 선택적 흐름을 표현합니다.

~~~mermaid
sequenceDiagram
    participant User
    participant Server
    participant Database

    User->>Server: 데이터 요청 (ID)
    activate Server

    alt ID가 유효한 경우
        Server->>Database: 데이터 조회 (ID)
        activate Database
        Database-->>Server: 조회된 데이터
        deactivate Database
        Server-->>User: 요청 데이터 전달
    else ID가 유효하지 않거나 없는 경우
        Server-->>User: 오류: 잘못된 ID 또는 데이터 없음
    end

    opt 추가 작업 수행 (선택적)
        Server->>Server: 내부 로그 기록
    end
    deactivate Server
~~~

**설명:**
* `alt ... else ... end`: 여러 대안적인 경로 중 하나를 선택합니다.
* `opt ... end`: 선택적으로 발생하는 경로를 나타냅니다.

## 3. 반복: `loop`

특정 조건 동안 반복되는 상호작용을 표현합니다.

~~~mermaid
sequenceDiagram
    participant Client
    participant Server

    loop 매 5초마다 상태 확인
        Client->>Server: 현재 상태 요청
        activate Server
        Server-->>Client: 현재 상태 응답
        deactivate Server
    end
~~~

**설명:**
* `loop ... end`: 지정된 조건이나 횟수만큼 내부 메시지들이 반복됩니다.

## 4. 시각적 그룹핑: `rect rgb(...)`

논리적으로 관련된 메시지들을 배경색이 있는 사각형으로 묶어서 시각적으로 강조하거나 구분합니다.

~~~mermaid
sequenceDiagram
    participant SystemA
    participant SystemB
    participant SystemC

    SystemA->>SystemB: 초기 설정 데이터 전송

    rect rgb(220, 230, 240)
        note over SystemB,SystemC: 주요 데이터 처리 과정
        SystemB->>SystemC: 데이터 변환 요청
        activate SystemC
        SystemC-->>SystemB: 변환된 데이터
        deactivate SystemC
        SystemB->>SystemA: 처리 결과 보고
    end

    SystemA->>SystemB: 최종 완료 신호
~~~

**설명:**
* `rect rgb(R, G, B) ... end`: 지정된 색상의 배경을 가진 사각형으로 메시지 그룹을 감싸 시각적으로 구분합니다.
* `note over ...`: 그룹에 대한 설명을 노트로 추가할 수 있습니다. (선택 사항)

## 5. 병렬 처리 (논리적): `par`

동시에 발생하는 것처럼 보이는 여러 작업 흐름을 표현합니다. (실제 블록체인 트랜잭션은 순차적일 수 있으나, 논리적 동시성을 나타낼 때 사용)

~~~mermaid
sequenceDiagram
    participant User
    participant Service1
    participant Service2
    participant Aggregator

    User->>Aggregator: 복합 작업 요청
    activate Aggregator
    par
        Aggregator->>Service1: 작업 A 요청
        activate Service1
        Service1-->>Aggregator: 작업 A 결과
        deactivate Service1
    and
        Aggregator->>Service2: 작업 B 요청
        activate Service2
        Service2-->>Aggregator: 작업 B 결과
        deactivate Service2
    end
    Aggregator-->>User: 최종 결과 (A와 B 종합)
    deactivate Aggregator
~~~

**설명:**
* `par ... and ... end`: `Service1`에 대한 작업과 `Service2`에 대한 작업이 논리적으로 병행하여 처리되는 것처럼 보입니다.

## 6. 중요 영역: `critical`

원자적이거나 동시 접근이 제한되어야 하는 중요한 상호작용을 표현합니다. (주로 동시성 제어와 관련된 개념을 나타낼 때 사용)

~~~mermaid
sequenceDiagram
    participant Client1
    participant Client2
    participant SharedResource

    par
        Client1->>SharedResource: 자원 접근 시도
        activate SharedResource
        critical 자원 잠금 및 업데이트
            SharedResource->>SharedResource: 내부 상태 변경
        end
        SharedResource-->>Client1: 작업 완료
        deactivate SharedResource
    and
        Client2->>SharedResource: 자원 접근 시도 (대기 가능성)
    end
~~~
**주의:** `critical` 프레그먼트는 일부 Mermaid 렌더러에서 `group`과 시각적으로 동일하게 표시될 수 있으나, 의미론적으로는 다릅니다.

## 7. 노트 및 주석

다이어그램에 추가적인 설명을 넣는 방법입니다.

~~~mermaid
sequenceDiagram
    participant A
    participant B

    A->>B: 중요한 메시지
    note over A,B: 이 메시지는 시스템의 핵심입니다.

    B-->>A: 응답
    %% 이것은 Mermaid 코드 내의 주석입니다. 렌더링되지 않습니다.
~~~

**설명:**
* `note [위치] of [참여자1],[참여자2]: 내용`: 특정 참여자(들) 위나 옆에 노트를 추가합니다.
* `%% 주석 내용`: `%%`로 시작하는 줄은 주석 처리되어 다이어그램에 나타나지 않습니다.

---

이 예제들이 Mermaid 시퀀스 다이어그램의 다양한 기능을 이해하고 활용하시는 데 도움이 되기를 바랍니다. 각 프로젝트의 특성과 표현하고자 하는 내용에 맞춰 적절한 기능들을 조합하여 사용하시면 됩니다.