---
sidebar_position: 5
---

# Reward Vault

---

### Interface

```
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.19;

/**
 * @title IRewardVault
 * @notice Interface for the Reward Vault contract, which manages KASH rewards for staking pools.
 */
interface IRewardVault {
    // --- Structs ---

    /**
     * @notice Stores allocation information for a staking pool.
     * @param totalAllocated The total KASH amount allocated to the pool.
     * @param distributedAmount The total KASH amount already distributed to the pool.
     * @param remainingAmount The KASH amount remaining to be distributed to the pool.
     */
    struct PoolAllocationData {
        uint256 totalAllocated;
        uint256 distributedAmount;
        uint256 remainingAmount;
    }

    // --- Events ---

    /**
     * @notice Emitted when KASH rewards are deposited into the vault.
     * @param depositor The address that deposited the rewards (e.g., Treasury).
     * @param amount The amount of KASH tokens deposited.
     */
    event RewardsDepositedToVault(address indexed depositor, uint256 amount);

    /**
     * @notice Emitted when total rewards are allocated to a specific staking pool.
     * @param stakingPoolAddress The address of the Staking Pool.
     * @param totalAllocation The total KASH amount allocated to this pool.
     */
    event PoolRewardsAllocated(address indexed stakingPoolAddress, uint256 totalAllocation);

    /**
     * @notice Emitted when epoch rewards are distributed to a specific staking pool.
     * @param stakingPoolAddress The address of the Staking Pool.
     * @param epochRewardAmount The KASH amount distributed in this epoch.
     * @param newTotalDistributedForPool The new total KASH amount distributed to this pool so far.
     */
    event EpochRewardDistributedToPool(
        address indexed stakingPoolAddress,
        uint256 epochRewardAmount,
        uint256 newTotalDistributedForPool
    );

    /**
     * @notice Emitted when the Keeper address is updated.
     * @param oldKeeperAddress The previous Keeper address.
     * @param newKeeperAddress The new Keeper address.
     */
    event KeeperAddressSet(address indexed oldKeeperAddress, address indexed newKeeperAddress);

    /**
     * @notice Emitted when a staking pool's supported status is changed.
     * @param stakingPoolAddress The address of the Staking Pool.
     * @param isSupported True if the pool is now supported, false otherwise.
     */
    event SupportedStakingPoolStatusChanged(address indexed stakingPoolAddress, bool isSupported);

    /**
     * @notice Emitted when reward parameters for a pool are set or updated.
     * @param stakingPoolAddress The address of the Staking Pool.
     * @param gValue The epoch reward growth rate (e.g., 0.01 * 1e18 for 1%).
     * @param rewardBase The base reward for the first epoch.
     * @param numEpochs The total number of epochs for the pool.
     */
    event PoolRewardParametersSet(
        address indexed stakingPoolAddress,
        uint256 gValue,
        uint256 rewardBase,
        uint256 numEpochs
        // Potentially other parameters if needed
    );

    // --- Functions ---

    /**
     * @notice Deposits KASH rewards into the vault.
     * @dev Should only be callable by Owner or Treasury.
     * @param amount The amount of KASH tokens to deposit.
     */
    function depositRewardsToVault(uint256 amount) external;

    /**
     * @notice Allocates a total amount of KASH rewards for a specific staking pool (for internal accounting).
     * @dev Should only be callable by Owner or Admin.
     * @param stakingPoolAddress The address of the Staking Pool.
     * @param totalAllocationForPool The total KASH amount allocated to this pool.
     */
    function allocateRewardsForPool(address stakingPoolAddress, uint256 totalAllocationForPool) external;

    /**
     * @notice Distributes KASH rewards for the current epoch to a specific Staking Pool.
     * @dev Should only be callable by a trusted Keeper.
     * This function will internally transfer KASH to the Staking Pool and call its `depositReward` function.
     * @param stakingPoolAddress The address of the Staking Pool.
     * @param epochRewardAmount The KASH amount to distribute for the current epoch.
     */
    function distributeEpochRewardToPool(address stakingPoolAddress, uint256 epochRewardAmount) external;

    /**
     * @notice Gets the total KASH balance held by this vault.
     * @return The total KASH balance.
     */
    function getVaultBalance() external view returns (uint256);

    /**
     * @notice Gets the reward allocation information for a specific staking pool.
     * @param stakingPoolAddress The address of the Staking Pool.
     * @return A `PoolAllocationData` struct containing allocation details.
     */
    function getPoolAllocationInfo(address stakingPoolAddress) external view returns (PoolAllocationData memory);

    // --- Admin Functions ---

    /**
     * @notice Sets the address of the Keeper contract authorized to call `distributeEpochRewardToPool`.
     * @dev Should only be callable by Owner or Admin.
     * @param _keeperAddress The new Keeper address.
     */
    function setKeeperAddress(address _keeperAddress) external;

    /**
     * @notice Adds or removes a staking pool from the list of pools the vault can interact with.
     * @dev Should only be callable by Owner or Admin.
     * @param stakingPoolAddress The address of the Staking Pool.
     * @param isSupported True if the pool should be supported, false otherwise.
     */
    function addSupportedStakingPool(address stakingPoolAddress, bool isSupported) external;

    /**
     * @notice (Optional) Sets pool-specific reward parameters if the Vault needs to calculate or validate epoch reward amounts.
     * @dev Should only be callable by Owner or Admin.
     * @param stakingPoolAddress The address of the Staking Pool.
     * @param gValue The epoch reward growth rate (e.g., 100 for 1% if using 1e4 precision, or scaled if using 1e18).
     * @param rewardBase The base reward for the first epoch for this pool, in KASH.
     * @param numEpochs The total number of epochs for which this pool will receive rewards.
     * @// Add other parameters as necessary for the reward calculation formula.
     */
    function setPoolRewardParameters(
        address stakingPoolAddress,
        uint256 gValue,
        uint256 rewardBase,
        uint256 numEpochs
        // Potentially other parameters like pool duration if not derived from numEpochs
    ) external;
}
```